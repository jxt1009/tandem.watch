(()=>{let e={isConnected:!1,roomId:null,userId:null,hasLocalStream:!1};const t=document.getElementById("status"),n=document.getElementById("status-text"),s=document.getElementById("controls-section"),o=document.getElementById("party-info"),d=document.getElementById("stats-section"),i=document.getElementById("video-section"),r=document.getElementById("start-btn"),c=document.getElementById("stop-btn"),m=document.getElementById("reset-btn"),l=document.getElementById("room-input"),a=document.getElementById("room-display"),u=document.getElementById("user-display"),y=document.getElementById("local-time"),g=document.getElementById("sync-status"),E=document.getElementById("remote-users-list"),v=document.getElementById("local-video"),I=document.getElementById("remote-video"),h=document.getElementById("copy-room-btn");function p(){chrome.runtime.sendMessage({type:"GET_STATUS"},l=>{chrome.runtime.lastError||l&&(e=l,function(){const{isConnected:l,roomId:y,userId:g}=e;l?(t.className="status connected",n.textContent="ðŸŸ¢ Connected",s.classList.remove("hidden"),r.classList.add("hidden"),c.classList.remove("hidden"),m.classList.remove("hidden"),o.classList.remove("hidden"),d.classList.remove("hidden"),a.textContent=y,u.textContent=g,T()):(t.className="status disconnected",n.textContent="ðŸ”´ Disconnected",s.classList.remove("hidden"),r.classList.remove("hidden"),c.classList.add("hidden"),m.classList.add("hidden"),o.classList.add("hidden"),d.classList.add("hidden"),i.classList.add("hidden"),v.srcObject=null,I.srcObject=null)}())})}function T(){chrome.tabs.query({active:!0,currentWindow:!0},e=>{e[0]&&e[0].url&&e[0].url.includes("netflix.com")&&chrome.tabs.sendMessage(e[0].id,{type:"GET_PARTY_STATS"},e=>{!chrome.runtime.lastError&&e&&(y&&(y.textContent=e.localTime||"--:--"),g&&(g.textContent=e.connected?"In Sync":"Disconnected",g.style.color=e.connected?"#4ade80":"#ef4444"),E&&e.remoteUsers&&(0===e.remoteUsers.length?E.innerHTML='<div style="color: rgba(255,255,255,0.5); font-size: 12px; font-style: italic;">No other users in party</div>':E.innerHTML='<div style="font-weight: 600; font-size: 12px; margin-bottom: 8px; color: rgba(255,255,255,0.7);">Remote Users:</div>'+e.remoteUsers.map(e=>`\n                <div style="padding: 6px 0; border-top: 1px solid rgba(255,255,255,0.1);">\n                  <div style="font-size: 11px; opacity: 0.7;">${e.id.substring(0,16)}...</div>\n                  <div style="font-weight: 600; color: #a78bfa; font-size: 12px;">${e.time}</div>\n                </div>\n              `).join("")))})})}p(),r.addEventListener("click",async function(){const e=l.value.trim()||void 0;r.disabled=!0,n.textContent="â³ Connecting...",chrome.runtime.sendMessage({type:"START_PARTY",roomId:e},e=>{e.success?setTimeout(p,500):(alert("Error: "+e.error),n.textContent="ðŸ”´ Disconnected",r.disabled=!1)})}),c.addEventListener("click",function(){chrome.runtime.sendMessage({type:"STOP_PARTY"},()=>{l.value="",p()})}),m.addEventListener("click",function(){const t=l.value.trim()||e.roomId||void 0;m.disabled=!0,n.textContent="â™»ï¸ Resetting...",chrome.runtime.sendMessage({type:"STOP_PARTY"},()=>{chrome.runtime.sendMessage({type:"START_PARTY",roomId:t},e=>{m.disabled=!1,e&&e.success?setTimeout(p,500):(alert("Error resetting party: "+(e&&e.error?e.error:"Unknown error")),n.textContent="ðŸ”´ Disconnected")})})}),h.addEventListener("click",function(){e.roomId&&(navigator.clipboard.writeText(e.roomId),h.textContent="âœ“",setTimeout(()=>{h.textContent="ðŸ“‹"},2e3))}),p(),setInterval(p,2e3),setInterval(()=>{e.isConnected&&T()},1e3),chrome.runtime.onMessage.addListener(e=>{"REMOTE_STREAM_RECEIVED"===e.type&&(I.srcObject=e.stream)})})();
//# sourceMappingURL=popup.js.map