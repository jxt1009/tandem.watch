{"version":3,"file":"popup.js","mappings":"MAAA,IAAIA,EAAS,CAAEC,aAAa,EAAOC,OAAQ,KAAMC,OAAQ,KAAMC,gBAAgB,GAE/E,MAAMC,EAAWC,SAASC,eAAe,UACnCC,EAAaF,SAASC,eAAe,eACrCE,EAAkBH,SAASC,eAAe,oBAC1CG,EAAYJ,SAASC,eAAe,cACpCI,EAAeL,SAASC,eAAe,iBACvCK,EAAeN,SAASC,eAAe,iBACvCM,EAAWP,SAASC,eAAe,aACnCO,EAAUR,SAASC,eAAe,YAClCQ,EAAWT,SAASC,eAAe,aACnCS,EAAYV,SAASC,eAAe,cACpCU,EAAcX,SAASC,eAAe,gBACtCW,EAAcZ,SAASC,eAAe,gBACtCY,EAAcb,SAASC,eAAe,cACtCa,EAAed,SAASC,eAAe,eACvCc,EAAkBf,SAASC,eAAe,qBAC1Ce,EAAahB,SAASC,eAAe,eACrCgB,EAAcjB,SAASC,eAAe,gBACtCiB,EAAclB,SAASC,eAAe,iBAa5C,SAASkB,IACPC,OAAOC,QAAQC,YAAY,CAAEC,KAAM,cAAiBC,IAC9CJ,OAAOC,QAAQI,WACfD,IACF9B,EAAS8B,EAMf,WACE,MAAM,YAAE7B,EAAW,OAAEC,EAAM,OAAEC,GAAWH,EACpCC,GACFI,EAAS2B,UAAY,mBACrBxB,EAAWyB,YAAc,eACzBxB,EAAgByB,UAAUC,OAAO,UACjCtB,EAASqB,UAAUE,IAAI,UACvBtB,EAAQoB,UAAUC,OAAO,UACzBpB,EAASmB,UAAUC,OAAO,UAC1BzB,EAAUwB,UAAUC,OAAO,UAC3BxB,EAAauB,UAAUC,OAAO,UAC9BlB,EAAYgB,YAAc/B,EAC1BgB,EAAYe,YAAc9B,EAC1BkC,MAEAhC,EAAS2B,UAAY,sBACrBxB,EAAWyB,YAAc,kBACzBxB,EAAgByB,UAAUC,OAAO,UACjCtB,EAASqB,UAAUC,OAAO,UAC1BrB,EAAQoB,UAAUE,IAAI,UACtBrB,EAASmB,UAAUE,IAAI,UACvB1B,EAAUwB,UAAUE,IAAI,UACxBzB,EAAauB,UAAUE,IAAI,UAC3BxB,EAAasB,UAAUE,IAAI,UAC3Bd,EAAWgB,UAAY,KACvBf,EAAYe,UAAY,KAE5B,CAhCMC,KAGN,CAyFA,SAASF,IAEPX,OAAOc,KAAKC,MAAM,CAAEC,QAAQ,EAAMC,eAAe,GAASH,IACpDA,EAAK,IAAMA,EAAK,GAAGI,KAAOJ,EAAK,GAAGI,IAAIC,SAAS,gBACjDnB,OAAOc,KAAKZ,YAAYY,EAAK,GAAGM,GAAI,CAAEjB,KAAM,mBAAsBC,KAC5DJ,OAAOC,QAAQI,WAAcD,IAG7BX,IACFA,EAAYc,YAAcH,EAASiB,WAAa,SAI9C3B,IACFA,EAAaa,YAAcH,EAASkB,UAAY,UAAY,eAC5D5B,EAAa6B,MAAMC,MAAQpB,EAASkB,UAAY,UAAY,WAI1D3B,GAAmBS,EAASqB,cACM,IAAhCrB,EAASqB,YAAYC,OACvB/B,EAAgBgC,UAAY,gHAE5BhC,EAAgBgC,UAAY,wHAC1BvB,EAASqB,YAAYG,IAAIC,GAAQ,+JAEiBA,EAAKT,GAAGU,UAAU,EAAG,mGACDD,EAAKE,sDAExEC,KAAK,SAMtB,CA/IAjC,IAKEZ,EAAS8C,iBAAiB,QA6C5BC,iBACE,MAAM1D,EAASc,EAAU6C,MAAMC,aAAUC,EACzClD,EAASmD,UAAW,EACpBxD,EAAWyB,YAAc,kBACzBP,OAAOC,QAAQC,YAAY,CAAEC,KAAM,cAAe3B,UAAW4B,IACvDA,EAASmC,QACXC,WAAWzC,EAAc,MAEzB0C,MAAM,UAAYrC,EAASsC,OAC3B5D,EAAWyB,YAAc,kBACzBpB,EAASmD,UAAW,IAG1B,GAzDElD,EAAQ6C,iBAAiB,QA2D3B,WACEjC,OAAOC,QAAQC,YAAY,CAAEC,KAAM,cAAgB,KACjDb,EAAU6C,MAAQ,GAClBpC,KAEJ,GA/DEV,EAAS4C,iBAAiB,QAiE5B,WACE,MAAMU,EAAgBrD,EAAU6C,MAAMC,QAAU9D,EAAOE,aAAU6D,EACjEhD,EAASiD,UAAW,EACpBxD,EAAWyB,YAAc,kBACzBP,OAAOC,QAAQC,YAAY,CAAEC,KAAM,cAAgB,KACjDH,OAAOC,QAAQC,YAAY,CAAEC,KAAM,cAAe3B,OAAQmE,GAAkBvC,IAC1Ef,EAASiD,UAAW,EAChBlC,GAAYA,EAASmC,QACvBC,WAAWzC,EAAc,MAEzB0C,MAAM,2BAA6BrC,GAAYA,EAASsC,MAAQtC,EAASsC,MAAQ,kBACjF5D,EAAWyB,YAAc,sBAIjC,GA/EET,EAAYmC,iBAAiB,QAiF/B,WACM3D,EAAOE,SACToE,UAAUC,UAAUC,UAAUxE,EAAOE,QACrCsB,EAAYS,YAAc,IAC1BiC,WAAW,KAAQ1C,EAAYS,YAAc,MAAS,KAE1D,GAGER,IACAgD,YAAYhD,EAAc,KAE1BgD,YAAY,KACNzE,EAAOC,aACToC,KAED,KAwCLX,OAAOC,QAAQ+C,UAAUC,YAAaC,IACf,2BAAjBA,EAAQ/C,OACVN,EAAYe,UAAYsC,EAAQC,S","sources":["webpack://toperparty/./chrome-extension/src/ui/popup.main.js"],"sourcesContent":["let status = { isConnected: false, roomId: null, userId: null, hasLocalStream: false };\r\n\r\nconst statusEl = document.getElementById('status');\r\nconst statusText = document.getElementById('status-text');\r\nconst controlsSection = document.getElementById('controls-section');\r\nconst partyInfo = document.getElementById('party-info');\r\nconst statsSection = document.getElementById('stats-section');\r\nconst videoSection = document.getElementById('video-section');\r\nconst startBtn = document.getElementById('start-btn');\r\nconst stopBtn = document.getElementById('stop-btn');\r\nconst resetBtn = document.getElementById('reset-btn');\r\nconst roomInput = document.getElementById('room-input');\r\nconst roomDisplay = document.getElementById('room-display');\r\nconst userDisplay = document.getElementById('user-display');\r\nconst localTimeEl = document.getElementById('local-time');\r\nconst syncStatusEl = document.getElementById('sync-status');\r\nconst remoteUsersList = document.getElementById('remote-users-list');\r\nconst localVideo = document.getElementById('local-video');\r\nconst remoteVideo = document.getElementById('remote-video');\r\nconst copyRoomBtn = document.getElementById('copy-room-btn');\r\n\r\nupdateStatus();\r\nsetupEventListeners();\r\nstartStatusPolling();\r\n\r\nfunction setupEventListeners() {\r\n  startBtn.addEventListener('click', startParty);\r\n  stopBtn.addEventListener('click', stopParty);\r\n  resetBtn.addEventListener('click', resetParty);\r\n  copyRoomBtn.addEventListener('click', copyRoomId);\r\n}\r\n\r\nfunction updateStatus() {\r\n  chrome.runtime.sendMessage({ type: 'GET_STATUS' }, (response) => {\r\n    if (chrome.runtime.lastError) return;\r\n    if (response) {\r\n      status = response;\r\n      updateUI();\r\n    }\r\n  });\r\n}\r\n\r\nfunction updateUI() {\r\n  const { isConnected, roomId, userId } = status;\r\n  if (isConnected) {\r\n    statusEl.className = 'status connected';\r\n    statusText.textContent = 'ðŸŸ¢ Connected';\r\n    controlsSection.classList.remove('hidden');\r\n    startBtn.classList.add('hidden');\r\n    stopBtn.classList.remove('hidden');\r\n    resetBtn.classList.remove('hidden');\r\n    partyInfo.classList.remove('hidden');\r\n    statsSection.classList.remove('hidden');\r\n    roomDisplay.textContent = roomId;\r\n    userDisplay.textContent = userId;\r\n    updateStats();\r\n  } else {\r\n    statusEl.className = 'status disconnected';\r\n    statusText.textContent = 'ðŸ”´ Disconnected';\r\n    controlsSection.classList.remove('hidden');\r\n    startBtn.classList.remove('hidden');\r\n    stopBtn.classList.add('hidden');\r\n    resetBtn.classList.add('hidden');\r\n    partyInfo.classList.add('hidden');\r\n    statsSection.classList.add('hidden');\r\n    videoSection.classList.add('hidden');\r\n    localVideo.srcObject = null;\r\n    remoteVideo.srcObject = null;\r\n  }\r\n}\r\n\r\nasync function startParty() {\r\n  const roomId = roomInput.value.trim() || undefined;\r\n  startBtn.disabled = true;\r\n  statusText.textContent = 'â³ Connecting...';\r\n  chrome.runtime.sendMessage({ type: 'START_PARTY', roomId }, (response) => {\r\n    if (response.success) {\r\n      setTimeout(updateStatus, 500);\r\n    } else {\r\n      alert('Error: ' + response.error);\r\n      statusText.textContent = 'ðŸ”´ Disconnected';\r\n      startBtn.disabled = false;\r\n    }\r\n  });\r\n}\r\n\r\nfunction stopParty() {\r\n  chrome.runtime.sendMessage({ type: 'STOP_PARTY' }, () => {\r\n    roomInput.value = '';\r\n    updateStatus();\r\n  });\r\n}\r\n\r\nfunction resetParty() {\r\n  const desiredRoomId = roomInput.value.trim() || status.roomId || undefined;\r\n  resetBtn.disabled = true;\r\n  statusText.textContent = 'â™»ï¸ Resetting...';\r\n  chrome.runtime.sendMessage({ type: 'STOP_PARTY' }, () => {\r\n    chrome.runtime.sendMessage({ type: 'START_PARTY', roomId: desiredRoomId }, (response) => {\r\n      resetBtn.disabled = false;\r\n      if (response && response.success) {\r\n        setTimeout(updateStatus, 500);\r\n      } else {\r\n        alert('Error resetting party: ' + (response && response.error ? response.error : 'Unknown error'));\r\n        statusText.textContent = 'ðŸ”´ Disconnected';\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\nfunction copyRoomId() {\r\n  if (status.roomId) {\r\n    navigator.clipboard.writeText(status.roomId);\r\n    copyRoomBtn.textContent = 'âœ“';\r\n    setTimeout(() => { copyRoomBtn.textContent = 'ðŸ“‹'; }, 2000);\r\n  }\r\n}\r\n\r\nfunction startStatusPolling() {\r\n  updateStatus();\r\n  setInterval(updateStatus, 2000);\r\n  // Update stats more frequently when connected\r\n  setInterval(() => {\r\n    if (status.isConnected) {\r\n      updateStats();\r\n    }\r\n  }, 1000);\r\n}\r\n\r\nfunction updateStats() {\r\n  // Request stats from content script\r\n  chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {\r\n    if (tabs[0] && tabs[0].url && tabs[0].url.includes('netflix.com')) {\r\n      chrome.tabs.sendMessage(tabs[0].id, { type: 'GET_PARTY_STATS' }, (response) => {\r\n        if (chrome.runtime.lastError || !response) return;\r\n        \r\n        // Update local time\r\n        if (localTimeEl) {\r\n          localTimeEl.textContent = response.localTime || '--:--';\r\n        }\r\n        \r\n        // Update sync status\r\n        if (syncStatusEl) {\r\n          syncStatusEl.textContent = response.connected ? 'In Sync' : 'Disconnected';\r\n          syncStatusEl.style.color = response.connected ? '#4ade80' : '#ef4444';\r\n        }\r\n        \r\n        // Update remote users\r\n        if (remoteUsersList && response.remoteUsers) {\r\n          if (response.remoteUsers.length === 0) {\r\n            remoteUsersList.innerHTML = '<div style=\"color: rgba(255,255,255,0.5); font-size: 12px; font-style: italic;\">No other users in party</div>';\r\n          } else {\r\n            remoteUsersList.innerHTML = '<div style=\"font-weight: 600; font-size: 12px; margin-bottom: 8px; color: rgba(255,255,255,0.7);\">Remote Users:</div>' +\r\n              response.remoteUsers.map(user => `\r\n                <div style=\"padding: 6px 0; border-top: 1px solid rgba(255,255,255,0.1);\">\r\n                  <div style=\"font-size: 11px; opacity: 0.7;\">${user.id.substring(0, 16)}...</div>\r\n                  <div style=\"font-weight: 600; color: #a78bfa; font-size: 12px;\">${user.time}</div>\r\n                </div>\r\n              `).join('');\r\n          }\r\n        }\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\nchrome.runtime.onMessage.addListener((request) => {\r\n  if (request.type === 'REMOTE_STREAM_RECEIVED') {\r\n    remoteVideo.srcObject = request.stream;\r\n  }\r\n});\r\n"],"names":["status","isConnected","roomId","userId","hasLocalStream","statusEl","document","getElementById","statusText","controlsSection","partyInfo","statsSection","videoSection","startBtn","stopBtn","resetBtn","roomInput","roomDisplay","userDisplay","localTimeEl","syncStatusEl","remoteUsersList","localVideo","remoteVideo","copyRoomBtn","updateStatus","chrome","runtime","sendMessage","type","response","lastError","className","textContent","classList","remove","add","updateStats","srcObject","updateUI","tabs","query","active","currentWindow","url","includes","id","localTime","connected","style","color","remoteUsers","length","innerHTML","map","user","substring","time","join","addEventListener","async","value","trim","undefined","disabled","success","setTimeout","alert","error","desiredRoomId","navigator","clipboard","writeText","setInterval","onMessage","addListener","request","stream"],"ignoreList":[],"sourceRoot":""}