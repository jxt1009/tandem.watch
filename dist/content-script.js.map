{"version":3,"file":"content-script.js","mappings":"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","sources":["webpack://toperparty/./chrome-extension/src/managers/sync/lock.js","webpack://toperparty/./chrome-extension/src/managers/sync/debounce.js","webpack://toperparty/./chrome-extension/src/managers/sync/SyncManager.js","webpack://toperparty/./chrome-extension/src/services/webrtc/peerConnection.js","webpack://toperparty/./chrome-extension/src/content/main.js","webpack://toperparty/./chrome-extension/src/managers/state/StateManager.js","webpack://toperparty/./chrome-extension/src/ui/UIManager.js","webpack://toperparty/./chrome-extension/src/content/netflix/NetflixController.js","webpack://toperparty/./chrome-extension/src/managers/sync/remoteHandlers.js","webpack://toperparty/./chrome-extension/src/managers/sync/eventListeners.js","webpack://toperparty/./chrome-extension/src/services/webrtc/WebRTCManager.js","webpack://toperparty/./chrome-extension/src/services/webrtc/ui.js","webpack://toperparty/./chrome-extension/src/services/webrtc/reconnect.js","webpack://toperparty/./chrome-extension/src/services/webrtc/signaling.js","webpack://toperparty/./chrome-extension/src/managers/url/URLSync.js"],"sourcesContent":["export class SyncLock {\n  constructor() {\n    this.suppressLocalUntil = 0;\n  }\n  set(durationMs) {\n    this.suppressLocalUntil = Date.now() + durationMs;\n  }\n  isActive() {\n    return Date.now() < this.suppressLocalUntil;\n  }\n}\n","export class EventDebouncer {\n  constructor(delayMs = 200) {\n    this.delayMs = delayMs;\n    this.timer = null;\n    this.events = new Set();\n  }\n  add(eventType) {\n    this.events.add(eventType);\n  }\n  schedule(fn) {\n    if (this.timer) clearTimeout(this.timer);\n    this.timer = setTimeout(() => {\n      const events = this.events;\n      this.events = new Set();\n      this.timer = null;\n      fn(events);\n    }, this.delayMs);\n  }\n  cancel() {\n    if (this.timer) clearTimeout(this.timer);\n    this.timer = null;\n    this.events.clear();\n  }\n}\n","import { SyncLock } from './lock.js';\nimport { EventDebouncer } from './debounce.js';\nimport { attachPlaybackListeners } from './eventListeners.js';\nimport { createRemoteHandlers } from './remoteHandlers.js';\n\nclass MutableRef {\n  constructor(value) { this.value = value; }\n  get() { return this.value; }\n  set(v) { this.value = v; }\n}\n\nexport class SyncManager {\n  constructor(stateManager, netflixController) {\n    this.state = stateManager;\n    this.netflix = netflixController;\n    this.lock = new SyncLock();\n    this.debouncer = new EventDebouncer(200);\n    this.isInitializedRef = new MutableRef(false);\n    this.listeners = null;\n    this.contextRef = new MutableRef({ lastUserInteractionAt: 0 });\n\n    this.remote = createRemoteHandlers({\n      state: this.state,\n      netflix: this.netflix,\n      lock: this.lock,\n      isInitializedRef: this.isInitializedRef,\n      contextRef: this.contextRef,\n    });\n  }\n\n  async setup() {\n    try {\n      const video = await this.waitForVideo();\n      if (!video) { console.warn('[SyncManager] Netflix video element not found'); return; }\n      this.isInitializedRef.set(false);\n      this.state.safeSendMessage({ type: 'REQUEST_SYNC' });\n      setTimeout(() => {\n        if (!this.isInitializedRef.get()) { this.isInitializedRef.set(true); }\n      }, 2000);\n      const listeners = attachPlaybackListeners({\n        video,\n        state: this.state,\n        isInitializedRef: this.isInitializedRef,\n        lock: this.lock,\n        debouncer: this.debouncer,\n        onBroadcast: (vid) => this.broadcastLocalState(vid),\n        onPassiveSyncContext: ({ now }) => {\n          this.state.safeSendMessage({\n            type: 'SYNC_TIME',\n            currentTime: video.currentTime,\n            isPlaying: !video.paused,\n            timestamp: now,\n          });\n        }\n      });\n      this.listeners = listeners;\n      this.contextRef.set(listeners.context);\n    } catch (err) { console.error('[SyncManager] Error setting up playback sync:', err); }\n  }\n\n  teardown() {\n    if (this.listeners && this.listeners.video) {\n      const { video, handleLocalEvent, handleTimeUpdate } = this.listeners;\n      try {\n        video.removeEventListener('play', handleLocalEvent);\n        video.removeEventListener('pause', handleLocalEvent);\n        video.removeEventListener('seeked', handleLocalEvent);\n        video.removeEventListener('timeupdate', handleTimeUpdate);\n      } catch (e) { console.warn('[SyncManager] Error removing listeners:', e); }\n      this.listeners = null;\n    }\n    this.debouncer.cancel();\n  }\n\n  waitForVideo() {\n    return new Promise((resolve, reject) => {\n      const timeout = setTimeout(() => reject(new Error('Video element timeout')), 10000);\n      const check = () => {\n        const video = this.netflix.getVideoElement();\n        if (video) { clearTimeout(timeout); resolve(video); }\n        else { setTimeout(check, 100); }\n      };\n      check();\n    });\n  }\n\n  broadcastLocalState(video) {\n    const currentTime = video.currentTime;\n    const isPlaying = !video.paused;\n    const events = new Set(this.debouncer.events);\n    // Priority: Seek > Play/Pause\n    if (events.has('seeked')) {\n      this.state.safeSendMessage({ type: 'SEEK', currentTime, isPlaying });\n    } else if (events.has('play') || events.has('pause')) {\n      const control = isPlaying ? 'play' : 'pause';\n      this.state.safeSendMessage({ type: 'PLAY_PAUSE', control, timestamp: currentTime });\n    }\n  }\n\n  // Remote API mirrors original methods\n  handleRequestSync(fromUserId) { return this.remote.handleRequestSync(fromUserId); }\n  handleSyncResponse(currentTime, isPlaying, fromUserId) { return this.remote.handleSyncResponse(currentTime, isPlaying, fromUserId); }\n  handlePlaybackControl(control, fromUserId) { return this.remote.handlePlaybackControl(control, fromUserId); }\n  handleSeek(currentTime, isPlaying, fromUserId) { return this.remote.handleSeek(currentTime, isPlaying, fromUserId); }\n  handlePassiveSync(currentTime, isPlaying, fromUserId, timestamp) { return this.remote.handlePassiveSync(currentTime, isPlaying, fromUserId, timestamp); }\n}\n","export function createPeerConnectionFactory({ stateManager, sendSignal, remoteStreams, remoteVideos, addRemoteVideo, attemptReconnection, clearReconnection, removeRemoteVideo, peersThatLeft }) {\n  return function createPeerConnection(peerId) {\n    const state = stateManager.getState();\n    const pc = new RTCPeerConnection({\n      iceServers: [\n        { urls: ['stun:stun.l.google.com:19302'] },\n        { urls: ['stun:stun1.l.google.com:19302'] }\n      ]\n    });\n    pc.onicecandidate = (event) => {\n      if (event.candidate) {\n        sendSignal({ type: 'ICE_CANDIDATE', from: state.userId, to: peerId, candidate: event.candidate });\n      }\n    };\n    pc.ontrack = (event) => {\n      let stream = (event.streams && event.streams[0]) || remoteStreams.get(peerId);\n      if (!stream) {\n        stream = new MediaStream();\n        remoteStreams.set(peerId, stream);\n      }\n      if (event.track) {\n        try { stream.addTrack(event.track); } catch (e) {}\n      }\n      if (!remoteVideos.has(peerId)) {\n        addRemoteVideo(peerId, stream);\n      }\n    };\n    pc.onconnectionstatechange = () => {\n      if (pc.connectionState === 'connected') {\n        clearReconnection(peerId);\n      } else if (pc.connectionState === 'disconnected' || pc.connectionState === 'failed') {\n        if (peersThatLeft.has(peerId)) {\n          removeRemoteVideo(peerId);\n          clearReconnection(peerId);\n        } else {\n          removeRemoteVideo(peerId);\n          attemptReconnection(peerId);\n        }\n      } else if (pc.connectionState === 'closed') {\n        removeRemoteVideo(peerId);\n        clearReconnection(peerId);\n      }\n    };\n    return pc;\n  };\n}\n\nexport function addOrReplaceTrack(pc, track, stream) {\n  const senders = pc.getSenders();\n  const existingSender = senders.find(s => s.track && s.track.kind === track.kind);\n  if (existingSender) {\n    existingSender.replaceTrack(track).catch(e => console.warn('[WebRTCManager] Error replacing track', e));\n  } else {\n    try { pc.addTrack(track, stream); } catch (e) {}\n  }\n}\n","import { StateManager } from '../managers/state/StateManager.js';\nimport { NetflixController } from './netflix/NetflixController.js';\nimport { SyncManager } from '../managers/sync/SyncManager.js';\nimport { WebRTCManager } from '../services/webrtc/WebRTCManager.js';\nimport { UIManager } from '../ui/UIManager.js';\nimport { URLSync } from '../managers/url/URLSync.js';\n\nconsole.log('[Content Script] Initializing managers...');\nconst stateManager = new StateManager();\nconst uiManager = new UIManager();\nconst netflixController = new NetflixController();\nconst syncManager = new SyncManager(stateManager, netflixController);\nconst webrtcManager = new WebRTCManager(stateManager, uiManager);\nconst urlSync = new URLSync(stateManager);\nconsole.log('[Content Script] Managers initialized');\n\nlet localStream = null;\n\n(function checkRestorePartyState() {\n  const restorationState = urlSync.getRestorationState();\n  if (restorationState) {\n    urlSync.clearState();\n    stateManager.setRestoringFlag(true);\n    setTimeout(function() {\n      chrome.runtime.sendMessage({ type: 'RESTORE_PARTY', roomId: restorationState.roomId });\n      setTimeout(function() {\n        stateManager.setRestoringFlag(false);\n      }, 2000);\n    }, 1000);\n  }\n})();\n\nchrome.runtime.onMessage.addListener((request, sender, sendResponse) => {\n  console.log('[Content Script] Received message:', request.type);\n  if (request.type === 'REQUEST_MEDIA_STREAM') {\n    navigator.mediaDevices.getUserMedia({ video: true, audio: true })\n      .then(stream => {\n        localStream = stream;\n        webrtcManager.setLocalStream(stream);\n        webrtcManager.onLocalStreamAvailable(stream);\n        sendResponse({ success: true });\n      })\n      .catch(err => sendResponse({ success: false, error: err.message }));\n    return true;\n  }\n\n  if (request.type === 'PARTY_STARTED') {\n    console.log('[Content Script] Party started:', request.userId, request.roomId);\n    stateManager.startParty(request.userId, request.roomId);\n    syncManager.setup();\n    urlSync.start();\n    sendResponse({ success: true });\n  }\n\n  if (request.type === 'PARTY_STOPPED') {\n    stateManager.stopParty();\n    syncManager.teardown();\n    urlSync.stop();\n    urlSync.clearState();\n    webrtcManager.clearAll();\n    if (localStream) {\n      localStream.getTracks().forEach(t => t.stop());\n      localStream = null;\n    }\n    sendResponse({ success: true });\n  }\n\n  if (request.type === 'SIGNAL') {\n    console.log('[Content Script] Handling SIGNAL:', request.message?.type);\n    webrtcManager.handleSignal(request.message);\n  }\n\n  if (request.type === 'APPLY_PLAYBACK_CONTROL') {\n    syncManager.handlePlaybackControl(request.control, request.fromUserId);\n  }\n\n  if (request.type === 'APPLY_SYNC_PLAYBACK') {\n    syncManager.handlePassiveSync(request.currentTime, request.isPlaying, request.fromUserId, request.timestamp);\n  }\n\n  if (request.type === 'APPLY_SEEK') {\n    syncManager.handleSeek(request.currentTime, request.isPlaying, request.fromUserId);\n  }\n\n  if (request.type === 'APPLY_URL_CHANGE') {\n    if (!stateManager.restoringPartyState) {\n      window.location.href = request.url;\n    }\n  }\n\n  if (request.type === 'HANDLE_REQUEST_SYNC') {\n    syncManager.handleRequestSync(request.fromUserId);\n  }\n\n  if (request.type === 'APPLY_SYNC_RESPONSE') {\n    syncManager.handleSyncResponse(request.currentTime, request.isPlaying, request.fromUserId);\n  }\n});\n\nwindow.addEventListener('beforeunload', () => {\n  if (stateManager.isActive()) {\n    urlSync.saveState();\n  }\n});\n","export class StateManager {\n  constructor() {\n    this.partyActive = false;\n    this.userId = null;\n    this.roomId = null;\n    this.restoringPartyState = false;\n  }\n  startParty(userId, roomId) {\n    this.partyActive = true;\n    this.userId = userId;\n    this.roomId = roomId;\n  }\n  stopParty() {\n    this.partyActive = false;\n    this.userId = null;\n    this.roomId = null;\n  }\n  isActive() { return this.partyActive; }\n  getUserId() { return this.userId; }\n  getRoomId() { return this.roomId; }\n  getState() {\n    return { partyActive: this.partyActive, userId: this.userId, roomId: this.roomId, restoringPartyState: this.restoringPartyState };\n  }\n  isInParty() { return !!(this.partyActive && this.userId && this.roomId); }\n  setRestoringFlag(value) { this.restoringPartyState = value; }\n  isExtensionContextValid() {\n    try { return chrome.runtime && chrome.runtime.id; } catch { return false; }\n  }\n  safeSendMessage(message, callback) {\n    if (!this.isExtensionContextValid()) return;\n    try { chrome.runtime.sendMessage(message, callback); } catch (e) { console.warn('Failed to send message:', e.message); }\n  }\n}\n","export class UIManager {\n  constructor() {\n    this.localPreviewVideo = null;\n    this.remoteVideos = new Map();\n    this.remoteStreams = new Map();\n    this.streamMonitorInterval = null;\n  }\n  getRemoteVideos() { return this.remoteVideos; }\n  getRemoteStreams() { return this.remoteStreams; }\n  setLocalPreviewVideo(video) { this.localPreviewVideo = video; }\n  getLocalPreviewVideo() { return this.localPreviewVideo; }\n  setStreamMonitorInterval(interval) { this.streamMonitorInterval = interval; }\n  getStreamMonitorInterval() { return this.streamMonitorInterval; }\n  clearStreamMonitorInterval() {\n    if (this.streamMonitorInterval) {\n      clearInterval(this.streamMonitorInterval);\n      this.streamMonitorInterval = null;\n    }\n  }\n  clearAll() {\n    this.localPreviewVideo = null;\n    this.remoteVideos.clear();\n    this.remoteStreams.clear();\n    this.clearStreamMonitorInterval();\n  }\n}\n","export class NetflixController {\n  constructor() { this.injectAPIBridge(); }\n  injectAPIBridge() {\n    const script = document.createElement('script');\n    script.src = chrome.runtime.getURL('netflix-api-bridge.js');\n    (document.head || document.documentElement).appendChild(script);\n    script.onload = function() { script.remove(); };\n  }\n  _sendCommand(command, args = []) {\n    return new Promise(function(resolve) {\n      const handler = function(e) {\n        if (e.detail.command === command) {\n          document.removeEventListener('__toperparty_response', handler);\n          resolve(e.detail.result);\n        }\n      };\n      document.addEventListener('__toperparty_response', handler);\n      setTimeout(function() { resolve(null); }, 1000);\n      document.dispatchEvent(new CustomEvent('__toperparty_command', { detail: { command, args } }));\n    });\n  }\n  play() { return this._sendCommand('play'); }\n  pause() { return this._sendCommand('pause'); }\n  seek(timeMs) { return this._sendCommand('seek', [timeMs]); }\n  getCurrentTime() { return this._sendCommand('getCurrentTime'); }\n  isPaused() { return this._sendCommand('isPaused'); }\n  getVideoElement() { return document.querySelector('video'); }\n}\n","export function createRemoteHandlers({ state, netflix, lock, isInitializedRef, contextRef }) {\n  async function applyRemote(actionName, durationMs, actionFn) {\n    lock.set(durationMs);\n    try { await actionFn(); } catch (err) {\n      console.error(`[SyncManager] Error applying remote ${actionName}:`, err);\n    }\n  }\n\n  return {\n    async handleRequestSync(fromUserId) {\n      if (!isInitializedRef.get()) return;\n      try {\n        const currentTime = await netflix.getCurrentTime();\n        const isPaused = await netflix.isPaused();\n        state.safeSendMessage({\n          type: 'SYNC_RESPONSE',\n          targetUserId: fromUserId,\n          currentTime: currentTime / 1000,\n          isPlaying: !isPaused\n        });\n      } catch (e) { console.error('[SyncManager] Error handling sync request:', e); }\n    },\n    async handleSyncResponse(currentTime, isPlaying, fromUserId) {\n      if (isInitializedRef.get()) return;\n      isInitializedRef.set(true);\n      await applyRemote('initial-sync', 2000, async () => {\n        await netflix.seek(currentTime * 1000);\n        const localPaused = await netflix.isPaused();\n        if (isPlaying && localPaused) await netflix.play();\n        else if (!isPlaying && !localPaused) await netflix.pause();\n      });\n    },\n    async handlePlaybackControl(control) {\n      await applyRemote(control, 1000, async () => {\n        if (control === 'play') await netflix.play();\n        else await netflix.pause();\n      });\n    },\n    async handleSeek(currentTime, isPlaying) {\n      await applyRemote('seek', 2000, async () => {\n        await netflix.seek(currentTime * 1000);\n        const isPaused = await netflix.isPaused();\n        if (isPlaying && isPaused) await netflix.play();\n        else if (!isPlaying && !isPaused) await netflix.pause();\n      });\n    },\n    async handlePassiveSync(currentTime, isPlaying, fromUserId, timestamp) {\n      const now = Date.now();\n      if (timestamp && (now - timestamp > 5000)) return;\n      if (now - contextRef.get().lastUserInteractionAt < 10000) return;\n      if (lock.isActive()) return;\n      try {\n        const localTimeMs = await netflix.getCurrentTime();\n        const targetMs = currentTime * 1000;\n        const driftMs = Math.abs(localTimeMs - targetMs);\n        if (driftMs <= 3000) return;\n        await applyRemote('passive-correction', 1500, async () => {\n          await netflix.seek(targetMs);\n          const localPaused = await netflix.isPaused();\n          if (isPlaying && localPaused) await netflix.play();\n          else if (!isPlaying && !localPaused) await netflix.pause();\n        });\n      } catch (err) { console.error('[SyncManager] Error handling passive sync:', err); }\n    }\n  };\n}\n","export function attachPlaybackListeners({ video, state, isInitializedRef, lock, debouncer, onBroadcast, onPassiveSyncContext }) {\n  const context = { lastUserInteractionAt: 0 };\n  const handleLocalEvent = (e) => {\n    if (!state.isActive()) return;\n    if (!isInitializedRef.get()) return;\n    if (lock.isActive()) return;\n    context.lastUserInteractionAt = Date.now();\n    debouncer.add(e.type);\n    debouncer.schedule(() => onBroadcast(video));\n  };\n\n  let lastPassiveSentAt = 0;\n  const handleTimeUpdate = () => {\n    if (!state.isActive()) return;\n    const now = Date.now();\n    if (lock.isActive()) return;\n    if (now - context.lastUserInteractionAt < 5000) return;\n    if (now - lastPassiveSentAt < 10000) return;\n    if (video.paused) return;\n    lastPassiveSentAt = now;\n    onPassiveSyncContext({ now, lastPassiveSentAt });\n  };\n\n  video.addEventListener('play', handleLocalEvent);\n  video.addEventListener('pause', handleLocalEvent);\n  video.addEventListener('seeked', handleLocalEvent);\n  video.addEventListener('timeupdate', handleTimeUpdate);\n\n  return { video, handleLocalEvent, handleTimeUpdate, context };\n}\n","import { createSignalingHandlers } from './signaling.js';\nimport { createPeerConnectionFactory, addOrReplaceTrack } from './peerConnection.js';\nimport { createReconnectionManager } from './reconnect.js';\nimport { createRemoteVideoManager } from './ui.js';\n\nexport class WebRTCManager {\n  constructor(stateManager, uiManager) {\n    this.stateManager = stateManager;\n    this.uiManager = uiManager;\n    this.peerConnections = new Map();\n    this.remoteStreams = this.uiManager.getRemoteStreams();\n    this.remoteVideos = this.uiManager.getRemoteVideos();\n    this.peersThatLeft = new Set();\n    this.localStream = null;\n\n    const videoManager = createRemoteVideoManager(this.remoteVideos);\n    \n    const reconnectionManager = createReconnectionManager({\n      stateManager: this.stateManager,\n      peerConnections: this.peerConnections,\n      peersThatLeft: this.peersThatLeft,\n      localStream: () => this.localStream,\n      createPeer: null,\n      sendSignal: (msg) => this._sendSignal(msg),\n      addOrReplaceTrack\n    });\n\n    const createPeer = createPeerConnectionFactory({\n      stateManager: this.stateManager,\n      sendSignal: (msg) => this._sendSignal(msg),\n      remoteStreams: this.remoteStreams,\n      remoteVideos: this.remoteVideos,\n      addRemoteVideo: videoManager.add,\n      attemptReconnection: reconnectionManager.attempt,\n      clearReconnection: reconnectionManager.clear,\n      removeRemoteVideo: (peerId) => {\n        videoManager.remove(peerId);\n        this.remoteStreams.delete(peerId);\n      },\n      peersThatLeft: this.peersThatLeft\n    });\n\n    reconnectionManager.createPeer = createPeer;\n    this.reconnectionManager = reconnectionManager;\n    this.createPeer = createPeer;\n    this.videoManager = videoManager;\n\n    this.signalingHandlers = createSignalingHandlers({\n      getState: () => this.stateManager.getState(),\n      peerConnections: this.peerConnections,\n      peersThatLeft: this.peersThatLeft,\n      getLocalStream: () => this.localStream,\n      createPeer,\n      sendSignal: (msg) => this._sendSignal(msg),\n      addOrReplaceTrack,\n      clearReconnection: reconnectionManager.clear,\n      removeRemoteVideo: (peerId) => {\n        videoManager.remove(peerId);\n        this.remoteStreams.delete(peerId);\n      }\n    });\n  }\n\n  setLocalStream(stream) { this.localStream = stream; }\n  getLocalStream() { return this.localStream; }\n  \n  onLocalStreamAvailable(stream) {\n    this.localStream = stream;\n    this.peerConnections.forEach((pc) => {\n      try {\n        stream.getTracks().forEach(t => addOrReplaceTrack(pc, t, stream));\n      } catch (e) {}\n    });\n  }\n\n  async handleSignal(message) {\n    if (!message || !message.type) return;\n    const type = message.type;\n    const from = message.userId || message.from;\n    const to = message.to;\n    const state = this.stateManager.getState();\n    if (to && to !== state.userId) return;\n\n    if (type === 'JOIN' && from && from !== state.userId) {\n      await this.signalingHandlers.handleJoin(from);\n    } else if (type === 'OFFER' && message.offer && from && from !== state.userId) {\n      await this.signalingHandlers.handleOffer(from, message.offer);\n    } else if (type === 'ANSWER' && message.answer && from && from !== state.userId) {\n      await this.signalingHandlers.handleAnswer(from, message.answer);\n    } else if (type === 'ICE_CANDIDATE' && message.candidate && from && from !== state.userId) {\n      await this.signalingHandlers.handleIceCandidate(from, message.candidate);\n    } else if (type === 'LEAVE' && from) {\n      this.signalingHandlers.handleLeave(from);\n    }\n  }\n\n  attemptReconnection(peerId) {\n    return this.reconnectionManager.attempt(peerId);\n  }\n\n  _sendSignal(message) {\n    this.stateManager.safeSendMessage({ type: 'SIGNAL_SEND', message }, function() {});\n  }\n\n  clearAll() {\n    this.peerConnections.forEach((pc) => {\n      try { pc.close(); } catch (e) {}\n    });\n    this.peerConnections.clear();\n    this.peersThatLeft.clear();\n    this.remoteVideos.forEach((v) => {\n      try { if (v.srcObject) v.srcObject = null; } catch (e) {}\n      v.remove();\n    });\n    this.remoteVideos.clear();\n    this.remoteStreams.clear();\n    if (this.localStream) {\n      this.localStream.getTracks().forEach(track => track.stop());\n      this.localStream = null;\n    }\n  }\n}\n","export function createRemoteVideoManager(remoteVideos) {\n  function add(peerId, stream) {\n    remove(peerId);\n    const v = document.createElement('video');\n    v.id = 'toperparty-remote-' + peerId;\n    v.autoplay = true;\n    v.playsInline = true;\n    v.muted = true;\n    v.style.position = 'fixed';\n    v.style.bottom = '20px';\n    v.style.right = (20 + (remoteVideos.size * 180)) + 'px';\n    v.style.width = '240px';\n    v.style.height = '160px';\n    v.style.zIndex = 10001;\n    v.style.border = '2px solid #00aaff';\n    v.style.borderRadius = '4px';\n    try { v.srcObject = stream; } catch (e) { v.src = URL.createObjectURL(stream); }\n    document.body.appendChild(v);\n    remoteVideos.set(peerId, v);\n    try {\n      v.play().then(() => {\n        v.muted = false;\n        v.volume = 1.0;\n      }).catch(() => { v.muted = false; });\n    } catch (e) {}\n  }\n  \n  function remove(peerId) {\n    const v = remoteVideos.get(peerId);\n    if (v) {\n      try { if (v.srcObject) v.srcObject = null; } catch (e) {}\n      v.remove();\n      remoteVideos.delete(peerId);\n    }\n  }\n  \n  return { add, remove };\n}\n","export function createReconnectionManager({ stateManager, peerConnections, peersThatLeft, localStream, createPeer, sendSignal, addOrReplaceTrack }) {\n  const attempts = new Map();\n  const timeouts = new Map();\n  \n  function clear(peerId) {\n    attempts.delete(peerId);\n    const handle = timeouts.get(peerId);\n    if (handle) {\n      clearTimeout(handle);\n      timeouts.delete(peerId);\n    }\n  }\n  \n  async function attempt(peerId) {\n    if (!stateManager.isInParty()) return;\n    if (peersThatLeft.has(peerId)) {\n      clear(peerId);\n      return;\n    }\n    const count = attempts.get(peerId) || 0;\n    const maxAttempts = 5;\n    const backoffDelay = Math.min(1000 * Math.pow(2, count), 30000);\n    if (count >= maxAttempts) {\n      clear(peerId);\n      return;\n    }\n    attempts.set(peerId, count + 1);\n    const existing = timeouts.get(peerId);\n    if (existing) clearTimeout(existing);\n    const handle = setTimeout(async () => {\n      const oldPc = peerConnections.get(peerId);\n      if (oldPc) {\n        try { oldPc.close(); } catch (e) {}\n        peerConnections.delete(peerId);\n      }\n      try {\n        const pc = createPeer(peerId);\n        peerConnections.set(peerId, pc);\n        if (localStream) {\n          localStream.getTracks().forEach(t => addOrReplaceTrack(pc, t, localStream));\n        }\n        const offer = await pc.createOffer();\n        await pc.setLocalDescription(offer);\n        const state = stateManager.getState();\n        sendSignal({ type: 'OFFER', from: state.userId, to: peerId, offer: pc.localDescription });\n      } catch (err) {\n        console.error('[WebRTCManager] Reconnection failed:', err);\n        attempt(peerId);\n      }\n    }, backoffDelay);\n    timeouts.set(peerId, handle);\n  }\n  \n  return { attempt, clear };\n}\n","export function createSignalingHandlers({ getState, peerConnections, peersThatLeft, getLocalStream, createPeer, sendSignal, addOrReplaceTrack, clearReconnection, removeRemoteVideo }) {\n  return {\n    async handleJoin(from) {\n      console.log('[WebRTCManager] Handling JOIN from', from);\n      const state = getState();\n      if (from === state.userId) return;\n      peersThatLeft.delete(from);\n      if (peerConnections.has(from)) return;\n      try {\n        const pc = createPeer(from);\n        peerConnections.set(from, pc);\n        const stream = getLocalStream();\n        if (stream) {\n          stream.getTracks().forEach(t => addOrReplaceTrack(pc, t, stream));\n        }\n        const offer = await pc.createOffer();\n        await pc.setLocalDescription(offer);\n        sendSignal({ type: 'OFFER', from: state.userId, to: from, offer: pc.localDescription });\n      } catch (err) {\n        console.error('[WebRTCManager] Error handling JOIN:', err);\n        peerConnections.delete(from);\n      }\n    },\n    async handleOffer(from, offer) {\n      console.log('[WebRTCManager] Handling OFFER from', from);\n      const state = getState();\n      if (from === state.userId) return;\n      let pc = peerConnections.get(from);\n      if (pc && pc.signalingState !== 'closed') {\n        try { pc.close(); } catch (e) {}\n        peerConnections.delete(from);\n        pc = null;\n      }\n      if (!pc) {\n        pc = createPeer(from);\n        peerConnections.set(from, pc);\n      }\n      try {\n        await pc.setRemoteDescription(new RTCSessionDescription(offer));\n        const stream = getLocalStream();\n        if (stream) {\n          stream.getTracks().forEach(t => addOrReplaceTrack(pc, t, stream));\n        }\n        const answer = await pc.createAnswer();\n        await pc.setLocalDescription(answer);\n        sendSignal({ type: 'ANSWER', from: state.userId, to: from, answer: pc.localDescription });\n      } catch (err) {\n        console.error('[WebRTCManager] Error handling offer:', err);\n        peerConnections.delete(from);\n        try { pc.close(); } catch (e) {}\n      }\n    },\n    async handleAnswer(from, answer) {\n      console.log('[WebRTCManager] Handling ANSWER from', from);\n      const pc = peerConnections.get(from);\n      if (pc && pc.signalingState === 'have-local-offer') {\n        try {\n          await pc.setRemoteDescription(new RTCSessionDescription(answer));\n        } catch (err) {\n          console.error('[WebRTCManager] Error handling answer:', err);\n        }\n      }\n    },\n    async handleIceCandidate(from, candidate) {\n      console.log('[WebRTCManager] Handling ICE_CANDIDATE from', from);\n      const pc = peerConnections.get(from);\n      if (pc) {\n        try {\n          await pc.addIceCandidate(new RTCIceCandidate(candidate));\n        } catch (err) {\n          console.warn('[WebRTCManager] Error adding ICE candidate', err);\n        }\n      }\n    },\n    handleLeave(from) {\n      console.log('[WebRTCManager] Handling LEAVE from', from);\n      peersThatLeft.add(from);\n      const pc = peerConnections.get(from);\n      if (pc) {\n        try { pc.close(); } catch (e) {}\n        peerConnections.delete(from);\n      }\n      clearReconnection(from);\n      removeRemoteVideo(from);\n    }\n  };\n}\n","export class URLSync {\n  constructor(stateManager) {\n    this.stateManager = stateManager;\n    this.urlMonitorInterval = null;\n    this.lastUrl = null;\n  }\n  start() { this.lastUrl = window.location.href; }\n  stop() {\n    if (this.urlMonitorInterval) { clearInterval(this.urlMonitorInterval); this.urlMonitorInterval = null; }\n  }\n  saveState() {\n    const state = this.stateManager.getState();\n    if (!state.partyActive) return;\n    const existing = this.getRestorationState() || {};\n    const payload = {\n      roomId: state.roomId,\n      currentTime: existing.currentTime || null,\n      isPlaying: typeof existing.isPlaying === 'boolean' ? existing.isPlaying : null,\n      timestamp: Date.now()\n    };\n    sessionStorage.setItem('toperparty_restore', JSON.stringify(payload));\n  }\n  clearState() { sessionStorage.removeItem('toperparty_restore'); }\n  getRestorationState() {\n    const stored = sessionStorage.getItem('toperparty_restore');\n    if (!stored) return null;\n    try {\n      const state = JSON.parse(stored);\n      if (Date.now() - state.timestamp < 30000) { return state; }\n    } catch (e) { console.error('[toperparty] Failed to parse restoration state:', e); }\n    return null;\n  }\n}\n"],"names":["SyncLock","constructor","this","suppressLocalUntil","set","durationMs","Date","now","isActive","EventDebouncer","delayMs","timer","events","Set","add","eventType","schedule","fn","clearTimeout","setTimeout","cancel","clear","MutableRef","value","get","v","addOrReplaceTrack","pc","track","stream","existingSender","getSenders","find","s","kind","replaceTrack","catch","e","console","warn","addTrack","log","stateManager","partyActive","userId","roomId","restoringPartyState","startParty","stopParty","getUserId","getRoomId","getState","isInParty","setRestoringFlag","isExtensionContextValid","chrome","runtime","id","safeSendMessage","message","callback","sendMessage","uiManager","localPreviewVideo","remoteVideos","Map","remoteStreams","streamMonitorInterval","getRemoteVideos","getRemoteStreams","setLocalPreviewVideo","video","getLocalPreviewVideo","setStreamMonitorInterval","interval","getStreamMonitorInterval","clearStreamMonitorInterval","clearInterval","clearAll","netflixController","injectAPIBridge","script","document","createElement","src","getURL","head","documentElement","appendChild","onload","remove","_sendCommand","command","args","Promise","resolve","handler","detail","removeEventListener","result","addEventListener","dispatchEvent","CustomEvent","play","pause","seek","timeMs","getCurrentTime","isPaused","getVideoElement","querySelector","syncManager","state","netflix","lock","debouncer","isInitializedRef","listeners","contextRef","lastUserInteractionAt","remote","async","applyRemote","actionName","actionFn","err","error","handleRequestSync","fromUserId","currentTime","type","targetUserId","isPlaying","handleSyncResponse","localPaused","handlePlaybackControl","control","handleSeek","handlePassiveSync","timestamp","localTimeMs","targetMs","Math","abs","createRemoteHandlers","setup","waitForVideo","onBroadcast","onPassiveSyncContext","context","handleLocalEvent","lastPassiveSentAt","handleTimeUpdate","paused","attachPlaybackListeners","vid","broadcastLocalState","teardown","reject","timeout","Error","check","has","webrtcManager","peerConnections","peersThatLeft","localStream","videoManager","peerId","srcObject","delete","autoplay","playsInline","muted","style","position","bottom","right","size","width","height","zIndex","border","borderRadius","URL","createObjectURL","body","then","volume","createRemoteVideoManager","reconnectionManager","createPeer","sendSignal","attempts","timeouts","handle","attempt","count","backoffDelay","min","pow","existing","oldPc","close","getTracks","forEach","t","offer","createOffer","setLocalDescription","from","to","localDescription","createReconnectionManager","msg","_sendSignal","addRemoteVideo","attemptReconnection","clearReconnection","removeRemoteVideo","RTCPeerConnection","iceServers","urls","onicecandidate","event","candidate","ontrack","streams","MediaStream","onconnectionstatechange","connectionState","createPeerConnectionFactory","signalingHandlers","getLocalStream","handleJoin","handleOffer","signalingState","setRemoteDescription","RTCSessionDescription","answer","createAnswer","handleAnswer","handleIceCandidate","addIceCandidate","RTCIceCandidate","handleLeave","createSignalingHandlers","setLocalStream","onLocalStreamAvailable","handleSignal","stop","urlSync","urlMonitorInterval","lastUrl","start","window","location","href","saveState","getRestorationState","payload","sessionStorage","setItem","JSON","stringify","clearState","removeItem","stored","getItem","parse","restorationState","onMessage","addListener","request","sender","sendResponse","navigator","mediaDevices","getUserMedia","audio","success","url"],"ignoreList":[],"sourceRoot":""}